<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_sg_write_back_action_item">
    <sys_sg_write_back_action_item action="INSERT_OR_UPDATE">
        <description>Action Item to Create a New NeedIt record</description>
        <execution_script><![CDATA[(function WriteBackAction(input) {
    //Type appropriate comment here, and begin script below

    //Number of NeedIt records to create
    var recordsToMake = 5;

    // Declare and initialize variables used in the script
    var genNIRec;
    var i;
    var tableName = "x_58872_needit_needit";
    var requestTypeArray = ["facilities", "hr", "legal"];
    var selectRequestType = "";
    var selectWhatNeeded = 3;
    var pickDate = 1;
    var requestedForArray = [{
        "name": "Fred Luddy",
        "email": "fred.luddy@example.com"
    }, {
        "name": "Beth Anglin",
        "email": "beth.anglin@example.com"
    }, {
        "name": "System Administrator",
        "email": "admin@example.com"
    }];
    var pickUser = 10;


    //For loop to create records
    for (i = 0; i < recordsToMake; i++) {

        //Create an empty record for the NeedIt table
        genNIRec = new GlideRecord(tableName);
        genNIRec.newRecord();


        //Select a random value from the requestType array and set the Request Type field value (choice)
        selectRequestType = requestTypeArray[(Math.floor(Math.random() * 3))];
        genNIRec.setValue("u_request_type", selectRequestType);


        //Set the What needed field value (choice) from the Request Type and either 1 or 2
        selectWhatNeeded = (Math.floor(Math.random() * 2) + 1);
        genNIRec.setValue("u_what_needed", selectRequestType + selectWhatNeeded);

        //Set the Short description field value (string)
        genNIRec.setValue("short_description", "Automatically created NeedIt request: " + selectRequestType + ", " + selectRequestType + selectWhatNeeded);

        //Set the When needed field value (date/time) to a date between six months from now and six months ago
        var rightNow = new GlideDateTime();
        pickDate = (Math.floor(Math.random() * 366) - 182);
        rightNow.addDaysUTC(pickDate);
        genNIRec.setValue("u_when_needed", rightNow.getDate());


        //Set the Requested for field value (reference) by selecting a random user from requestedForArray.
        //Also set the Requested for email field value (string).  The reference field cannot be set in a scoped app
        //using the setValue method unless using the sys_id to set the field value.  To set by display name, use 
        //the GlideElement setDisplayValue method.  gr.<field_name>.setDisplayValue(<value>). 
        pickUser = (Math.floor(Math.random() * 3));
        genNIRec.u_requested_for.setDisplayValue(requestedForArray[pickUser].name);
        genNIRec.setValue("u_requested_for_email", requestedForArray[pickUser].email.toString());


        //Set the Priority field value (choice) to a random value
        genNIRec.setValue("priority", (Math.floor(Math.random() * 5) + 1));

        //Set the State field value (choice) to Requested
        genNIRec.setValue("state", 13);

        //Insert the new NeedIt record into the table
        genNIRec.insert();
    }

})(input);]]></execution_script>
        <name>Create a New NeedIt record</name>
        <parameter_screen/>
        <query_condition/>
        <sys_class_name>sys_sg_write_back_action_item</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2021-08-11 17:11:05</sys_created_on>
        <sys_id>99649b9f2f313010b17950492799b61a</sys_id>
        <sys_mod_count>4</sys_mod_count>
        <sys_name>Create a New NeedIt record</sys_name>
        <sys_package display_value="NeedIt" source="x_58872_needit">6ead8e780f603200cd674f8ce1050ed1</sys_package>
        <sys_policy/>
        <sys_scope display_value="NeedIt">6ead8e780f603200cd674f8ce1050ed1</sys_scope>
        <sys_update_name>sys_sg_write_back_action_item_99649b9f2f313010b17950492799b61a</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2021-08-11 17:19:32</sys_updated_on>
        <table>x_58872_needit_needit</table>
        <template>description={{Description}}^u_request_type={{Request type}}^u_requested_for={{Requested for}}^u_requested_for_email={{Requested for email}}^short_description={{Short description}}^u_what_needed={{What needed}}^u_when_needed={{When needed}}^EQ</template>
        <type>new</type>
        <use_current_record_as_condition>false</use_current_record_as_condition>
        <use_fields_for_ref_lookup>false</use_fields_for_ref_lookup>
    </sys_sg_write_back_action_item>
    <sys_translated_text action="delete_multiple" query="documentkey=99649b9f2f313010b17950492799b61a"/>
</record_update>
